<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AWS IoT Device Client: Aws::Iot::DeviceClient::Jobs::JobEngine Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWS IoT Device Client
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>Aws</b></li><li class="navelem"><b>Iot</b></li><li class="navelem"><b>DeviceClient</b></li><li class="navelem"><b>Jobs</b></li><li class="navelem"><a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html">JobEngine</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Aws::Iot::DeviceClient::Jobs::JobEngine Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Manages the execution of a Job.  
 <a href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_job_engine_8h_source.html">JobEngine.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aab65000d16ffe1c250c9af0c51d9abe6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#aab65000d16ffe1c250c9af0c51d9abe6">processCmdOutput</a> (int fd, bool isStdErr, int childPID)</td></tr>
<tr class="memdesc:aab65000d16ffe1c250c9af0c51d9abe6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used by output processing threads to assess output from the child process.  <a href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#aab65000d16ffe1c250c9af0c51d9abe6">More...</a><br /></td></tr>
<tr class="separator:aab65000d16ffe1c250c9af0c51d9abe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51fcb47a9ed2d8c32109d47cc4cfff6d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#a51fcb47a9ed2d8c32109d47cc4cfff6d">exec_cmd</a> (std::string action, std::vector&lt; std::string &gt; args)</td></tr>
<tr class="memdesc:a51fcb47a9ed2d8c32109d47cc4cfff6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the given command (action) and passes the provided vector of arguments to that command.  <a href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#a51fcb47a9ed2d8c32109d47cc4cfff6d">More...</a><br /></td></tr>
<tr class="separator:a51fcb47a9ed2d8c32109d47cc4cfff6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcc11a86226e74648e3a5395ae180171"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#abcc11a86226e74648e3a5395ae180171">hasErrors</a> ()</td></tr>
<tr class="memdesc:abcc11a86226e74648e3a5395ae180171"><td class="mdescLeft">&#160;</td><td class="mdescRight">Begin the execution of a command with the specified arguments.  <a href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#abcc11a86226e74648e3a5395ae180171">More...</a><br /></td></tr>
<tr class="separator:abcc11a86226e74648e3a5395ae180171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affcb240c8fd6c1fe197997131929c20e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#affcb240c8fd6c1fe197997131929c20e">getStdOut</a> ()</td></tr>
<tr class="memdesc:affcb240c8fd6c1fe197997131929c20e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take the STDOUT received from the child process.  <a href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#affcb240c8fd6c1fe197997131929c20e">More...</a><br /></td></tr>
<tr class="separator:affcb240c8fd6c1fe197997131929c20e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f3764967a7d06f30fe7e3df583b5040"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#a2f3764967a7d06f30fe7e3df583b5040">getStdErr</a> ()</td></tr>
<tr class="memdesc:a2f3764967a7d06f30fe7e3df583b5040"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take the STDERR received from the child process.  <a href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#a2f3764967a7d06f30fe7e3df583b5040">More...</a><br /></td></tr>
<tr class="separator:a2f3764967a7d06f30fe7e3df583b5040"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a3e391a699bb7c903498eead712a20288"><td class="memItemLeft" align="right" valign="top"><a id="a3e391a699bb7c903498eead712a20288"></a>
const char *&#160;</td><td class="memItemRight" valign="bottom"><b>TAG</b> = &quot;JobEngine.cpp&quot;</td></tr>
<tr class="separator:a3e391a699bb7c903498eead712a20288"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cac8361d8365feb7b0e5807abc07e33"><td class="memItemLeft" align="right" valign="top">std::atomic_int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#a1cac8361d8365feb7b0e5807abc07e33">errors</a> {0}</td></tr>
<tr class="memdesc:a1cac8361d8365feb7b0e5807abc07e33"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of lines received on STDERR from the child process.  <a href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#a1cac8361d8365feb7b0e5807abc07e33">More...</a><br /></td></tr>
<tr class="separator:a1cac8361d8365feb7b0e5807abc07e33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac90bc5fc6289d89cb012f0d6322b520c"><td class="memItemLeft" align="right" valign="top"><a id="ac90bc5fc6289d89cb012f0d6322b520c"></a>
<a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_limited_stream_buffer.html">Aws::Iot::DeviceClient::Jobs::LimitedStreamBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#ac90bc5fc6289d89cb012f0d6322b520c">stdoutstream</a></td></tr>
<tr class="memdesc:ac90bc5fc6289d89cb012f0d6322b520c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Partial output from STDOUT of the child process to be used in UpdateJobExecution. <br /></td></tr>
<tr class="separator:ac90bc5fc6289d89cb012f0d6322b520c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefc97336f6335fb64a11ee690c22d834"><td class="memItemLeft" align="right" valign="top"><a id="aefc97336f6335fb64a11ee690c22d834"></a>
<a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_limited_stream_buffer.html">Aws::Iot::DeviceClient::Jobs::LimitedStreamBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#aefc97336f6335fb64a11ee690c22d834">stderrstream</a></td></tr>
<tr class="memdesc:aefc97336f6335fb64a11ee690c22d834"><td class="mdescLeft">&#160;</td><td class="mdescRight">Partial output from STDERR of the child process to be used in UpdateJobExecution. <br /></td></tr>
<tr class="separator:aefc97336f6335fb64a11ee690c22d834"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a333eb4a7c9d0ec7143e2b954ee5a1be3"><td class="memItemLeft" align="right" valign="top"><a id="a333eb4a7c9d0ec7143e2b954ee5a1be3"></a>
static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html#a333eb4a7c9d0ec7143e2b954ee5a1be3">MAX_LOG_LINES</a> = 1000</td></tr>
<tr class="memdesc:a333eb4a7c9d0ec7143e2b954ee5a1be3"><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum number of lines that we'll read from STDOUT or STDERR of the child process before stopping. This prevents against log corruption in the event that the specified job generates a large volume of output. <br /></td></tr>
<tr class="separator:a333eb4a7c9d0ec7143e2b954ee5a1be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manages the execution of a Job. </p>
<p>The <a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html" title="Manages the execution of a Job.">JobEngine</a> is fully responsible for executing a given command and its arguments, which may point to handlers provided as part of the Device Client or to other executables available to the device. The <a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html" title="Manages the execution of a Job.">JobEngine</a> manages all of the setup required to redirect output from the child process so that it can be analyzed by the Jobs feature and used to determine job success. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a51fcb47a9ed2d8c32109d47cc4cfff6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51fcb47a9ed2d8c32109d47cc4cfff6d">&#9670;&nbsp;</a></span>exec_cmd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int JobEngine::exec_cmd </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes the given command (action) and passes the provided vector of arguments to that command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">action</td><td>the command to execute </td></tr>
    <tr><td class="paramname">args</td><td>the arguments to pass to that command </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an integer representing the return code of the executed process </dd></dl>

</div>
</div>
<a id="a2f3764967a7d06f30fe7e3df583b5040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f3764967a7d06f30fe7e3df583b5040">&#9670;&nbsp;</a></span>getStdErr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Aws::Iot::DeviceClient::Jobs::JobEngine::getStdErr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Take the STDERR received from the child process. </p>
<dl class="section return"><dt>Returns</dt><dd>a <a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_limited_stream_buffer.html" title="Used to buffer output from STDOUT or STDERR of the child process for placement in the status details ...">LimitedStreamBuffer</a> taken from the <a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html" title="Manages the execution of a Job.">JobEngine</a> </dd></dl>

</div>
</div>
<a id="affcb240c8fd6c1fe197997131929c20e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affcb240c8fd6c1fe197997131929c20e">&#9670;&nbsp;</a></span>getStdOut()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string Aws::Iot::DeviceClient::Jobs::JobEngine::getStdOut </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Take the STDOUT received from the child process. </p>
<dl class="section return"><dt>Returns</dt><dd>a <a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_limited_stream_buffer.html" title="Used to buffer output from STDOUT or STDERR of the child process for placement in the status details ...">LimitedStreamBuffer</a> taken from the <a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html" title="Manages the execution of a Job.">JobEngine</a> </dd></dl>

</div>
</div>
<a id="abcc11a86226e74648e3a5395ae180171"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcc11a86226e74648e3a5395ae180171">&#9670;&nbsp;</a></span>hasErrors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Aws::Iot::DeviceClient::Jobs::JobEngine::hasErrors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Begin the execution of a command with the specified arguments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">operation</td><td>the operation to perform, likely the path to an executable </td></tr>
    <tr><td class="paramname">args</td><td>the arguments to pass to the executable </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the return code of the child process, or an error code if it cannot be executed</dd></dl>
<p>Whether the <a class="el" href="class_aws_1_1_iot_1_1_device_client_1_1_jobs_1_1_job_engine.html" title="Manages the execution of a Job.">JobEngine</a> is reporting errors received from the child process</p>
<dl class="section return"><dt>Returns</dt><dd>an integer representing the number of lines received on STDERR </dd></dl>

</div>
</div>
<a id="aab65000d16ffe1c250c9af0c51d9abe6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab65000d16ffe1c250c9af0c51d9abe6">&#9670;&nbsp;</a></span>processCmdOutput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void JobEngine::processCmdOutput </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isStdErr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>childPID</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used by output processing threads to assess output from the child process. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>the file descriptor of the output to process </td></tr>
    <tr><td class="paramname">isStdErr</td><td>whether the output being processed is from STDERR </td></tr>
    <tr><td class="paramname">childPID</td><td>the process ID of the child process </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a1cac8361d8365feb7b0e5807abc07e33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cac8361d8365feb7b0e5807abc07e33">&#9670;&nbsp;</a></span>errors</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic_int Aws::Iot::DeviceClient::Jobs::JobEngine::errors {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of lines received on STDERR from the child process. </p>
<p>Used to determine whether the job was successful or not, since a script with multiple commands will return the return code of the final command and may not be indicative of whether all actions were successful. The incoming job document may include a property that specifies an acceptable number of STDERR lines to allow in case some errors are expected. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/aws-iot-device-client/aws-iot-device-client/source/jobs/<a class="el" href="_job_engine_8h_source.html">JobEngine.h</a></li>
<li>/home/runner/work/aws-iot-device-client/aws-iot-device-client/source/jobs/JobEngine.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
